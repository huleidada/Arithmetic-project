from scipy.optimize import linprog

# 假设运输成本（单位：元/吨）
# 3个仓库到4个零售商的运输成本矩阵
cost = [
    [8, 6, 10, 9],  # 仓库1到零售商的运输成本
    [9, 4, 7, 5],   # 仓库2到零售商的运输成本
    [3, 7, 4, 6]    # 仓库3到零售商的运输成本
]

# 供应量（每个仓库提供的货物量）
supply = [50, 60, 70]

# 需求量（每个零售商需要的货物量）
demand = [40, 50, 60, 30]

# 目标函数：最小化运输成本
c = [item for sublist in cost for item in sublist]  # 按行展开成本矩阵

# 约束条件：供应量和需求量
A_ub = []
b_ub = []

# 供应约束：每个仓库的出货量不能超过其供应量
for i in range(len(supply)):
    row = [0] * len(cost)
    for j in range(len(demand)):
        row[i * len(demand) + j] = 1
    A_ub.append(row)
    b_ub.append(supply[i])

# 需求约束：每个零售商的需求必须满足
for j in range(len(demand)):
    row = [0] * len(cost)
    for i in range(len(supply)):
        row[i * len(demand) + j] = 1
    A_ub.append(row)
    b_ub.append(demand[j])

# 变量的边界条件（每个运输量 >= 0）
bounds = [(0, None)] * len(c)

# 求解运输问题
res = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='simplex')

print("Optimal value (minimized cost):", res.fun)
print("Optimal transportation plan:")
print(res.x.reshape(len(supply), len(demand)))  # 重新排列成供应商与零售商的矩阵形式


# 实际案例：

# **生产计划优化**
# 在制造业中，线性规划可以帮助公司优化生产计划，以最大化利润或最小化生产成本。
# 假设有两种产品（产品1和产品2），公司希望在给定的资源约束下（如设备和劳动力），
# 最大化其总利润。每种产品需要不同数量的设备时间和劳动力，每种产品的单位利润也不同。

# 目标：最大化利润
# 产品1的单位利润是3，产品2的单位利润是5。
# 资源限制：公司有6单位设备时间和8单位劳动力时间。
# 产品1和产品2分别需要1单位设备时间和4单位劳动力时间，2单位设备时间和1单位劳动力时间。

# 目标函数：
# Maximize Z = 3x1 + 5x2

# 约束条件：
# x1 + 2x2 <= 6  (设备时间约束)
# 4x1 + x2 <= 8  (劳动力时间约束)

# **解法：**
# 通过线性规划算法求解，最优解的目标函数值为最大化利润，表示公司应该生产多少个产品1和产品2以获得最大利润。

# **运输优化**
# 运输问题是线性规划的经典应用，目标是最小化运输成本。我们需要从多个供应商向多个消费者运输商品，
# 且每个供应商和消费者的需求和供应量都是已知的。

# 假设公司需要将货物从3个仓库运输到4个零售商，每个仓库和零售商的运输成本不同，目标是最小化总运输成本。
# 假设运输成本如下：
# 仓库1到零售商的运输成本为8、6、10和9元/吨
# 仓库2到零售商的运输成本为9、4、7和5元/吨
# 仓库3到零售商的运输成本为3、7、4和6元/吨

# 供应量：仓库1的供应量为50吨，仓库2为60吨，仓库3为70吨
# 需求量：零售商1的需求为40吨，零售商2为50吨，零售商3为60吨，零售商4为30吨
# 目标是最小化运输总成本。

# **解法：**
# 通过线性规划算法求解，得到最优的运输方案和最小化的总运输成本。

# **资源分配优化**
# 在线性规划中，资源分配问题也非常常见。我们可以根据不同的约束条件优化资源的分配，
# 例如在广告预算分配中如何根据各个渠道的回报率进行投资分配，以最大化收益。

# 假设公司有3个广告渠道（电视、社交媒体、线上广告），
# 每个渠道的回报率分别为10、15和7（单位：回报单位/投资单位），
# 总广告预算为1000单位，但每个渠道的最小投资额分别为100、150和50单位。
# 目标是最大化广告的回报率。

# **解法：**
# 通过线性规划求解，确定最优的投资分配，以最大化回报。

# 公式：
# 目标函数（回报最大化）：
# Maximize Z = 10 * x1 + 15 * x2 + 7 * x3

# 约束条件：
# x1 >= 100  (电视广告最低投资额)
# x2 >= 150  (社交媒体最低投资额)
# x3 >= 50   (线上广告最低投资额)
# x1 + x2 + x3 <= 1000  (总预算约束)